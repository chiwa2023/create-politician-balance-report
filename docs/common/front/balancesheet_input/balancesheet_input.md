# 政治資金収支報告書仕様入力コンポーネント設計書

## 状態：手戻り上等！の姿勢で実装中(一次実装完了)

## 1. 目的

各種データを収支報告書データ形式として、実際のデータとして入力できるようにする

## 2. 構成コンポーネント

なし

## 3.画面イメージ

### 3.1 画面イメージ

![収支報告書入力](./image/収支報告書入力.drawio.png)

### 3.2 画面イメージ(項番)

![収支報告書入力](./image/収支報告書入力項番.drawio.png)

## 4. フィールド要素一覧

### 4.1 独自フィールド(収入テーブル)

| 番号 |           論理名           |        タイプ        |      活性／表示      |                                             内容                                             |
| ---- | -------------------------- | -------------------- | -------------------- | -------------------------------------------------------------------------------------------- |
| 1    | 参照摘要                   | インプットテキスト   | 非活性               | 入力補助できる情報を呼び出すキーであること                                                   |
| 2    | 発生日                     | インプット日付       | 非活性／活性         | このデータが発生した日付                                                                     |
| 3    | 金額                       | インプット数字       | 非活性／活性         | このデータで取引を行った金額                                                                 |
| 4    | 報告区分(報告対象)         | ラジオボタン         | 活性                 | 収支報告書に記載するデータであることを指定すること                                           |
| 5    | 報告区分(生活費)           | ラジオボタン         | 活性                 | 生活費であるため収支報告書に記載しないことを指定すること                                     |
| 6    | 報告区分(非報告)           | ラジオボタン         | 活性                 | 政治活動費ではあるが、収支報告書に記載しないデータであることを指定すること                   |
| 7    | 収支収入仕訳大項目         | セレクトボタン       | 活性                 | 収入の仕訳大項目を指定すること                                                               |
| 7    | 収支収入仕訳小項目         | セレクトボタン       | 活性                 | 収入の仕訳小項目を指定すること                                                               |
| 1    | 入力項目                   | インプットテキスト   | 活性<br>表示／非表示 | 選択された項目が氏名・名称入力を必要とする場合に表示<br>名称を表示すること                   |
| 1    | 氏名／職業                 | インプットテキスト   | 活性<br>表示／非表示 | 選択された項目が団体の名称または個人の場合は職業を必要とする場合に表示<br>氏名を表示すること |
| 1    | 住所                       | テキストエリア       | 活性<br>表示／非表示 | 選択された項目が住所入力を必要とする場合に表示<br>団体の住所を表示すること                   |
| 1    | あっせんで集めた期間開始日 | インプットカレンダー | 活性<br>表示／非表示 | あっせんを伴い、期間入力を必要とする場合に表示<br>期間の開始日を表示すること                 |
| 1    | あっせんで集めた期間終了日 | インプットカレンダー | 活性<br>表示／非表示 | あっせんを伴い、期間入力を必要とする場合に表示<br>期間の終了日を表示すること                 |
| 8    | パーティ名称               | インプットテキスト   | 活性<br>表示／非表示 | パーティごとに記載が必要な場合に個別のパーティ名称を入力できること                           |
| 9    | パーティ開催日             | インプットカレンダー | 活性<br>表示／非表示 | パーティ開催日の指定の入力を供すること                                                       |
| 1    | 備考                       | テキストエリア       | 活性<br>表示／非表示 | 備考を表示すること                                                                           |
| 1    | 遺贈有無                   | チェックボックス     | 活性<br>表示／非表示 | 値が`1:有`の場合には備考に『「遺贈」』と記入され、記入チェックがされること                   |
| 1    | 上場・外資50%以上チェック  | チェックボックス     | 活性<br>表示／非表示 | 値が`1:有`の場合には備考に『「上場・外資50%以上」』と記入され、記入チェックがされること      |
| 1    | 寄付金控除有無             | チェックボックス     | 活性<br>表示／非表示 | 寄付金控除の有無入力を受け付けること                                                         |
| 1    | 意見付記                   | チェックボックス     | 活性                 | 最新の意見付記の入力を受け付けること                                                         |
| 1    | 前例と異なる処理チェック   | チェックボックス     | 活性                 | この処理が前例と異なっていることの入力を受け付けること                                       |
| 1    | 自動入力編集チェック       | チェックボックス     | 活性                 | 自動入力部分を変更しようとしていることの入力を受け付けること                                 |

### 4.2 独自フィールド(支出テーブル)

| 番号 |           論理名           |       タイプ       |          活性／表示          |                                                              内容                                                              |
| ---- | -------------------------- | ------------------ | ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| 1    | 参照摘要                   | インプットテキスト | 非活性                       | 入力補助できる情報を呼び出すキーであること                                                                                     |
| 2    | 発生日                     | インプット日付     | 非活性／活性                 | このデータが発生した日付                                                                                                       |
| 3    | 金額                       | インプット数字     | 非活性／活性                 | このデータで取引を行った金額                                                                                                   |
| 4    | 報告区分(報告対象)         | ラジオボタン       | 活性                         | 収支報告書に記載するデータであることを指定すること                                                                             |
| 5    | 報告区分(生活費)           | ラジオボタン       | 活性                         | 生活費であるため収支報告書に記載しないことを指定すること                                                                       |
| 6    | 報告区分(非報告)           | ラジオボタン       | 活性                         | 政治活動費ではあるが、収支報告書に記載しないデータであることを指定すること                                                     |
| 7    | 収支支出仕訳大項目         | セレクトボタン     | 活性                         | 支出の仕訳大項目を指定すること                                                                                                 |
| 7    | 収支支出仕訳小項目         | セレクトボタン     | 活性                         | 支出の仕訳小項目を指定すること                                                                                                 |
| 1    | 小分類                     | インプットテキスト | 活性<br>表示／非表示         | パーティ名称など小分類ごとでの記載を要求されている場合の分類名                                                                 |
| 1    | 支出の目的                 | インプットテキスト | 活性<br>表示／非表示         | 選択された仕訳項目が支出の目的を必要とする場合に表示<br>摘要の入力を受け付けること                                             |
| 1    | 支出を受けたものの名称     | インプットテキスト | 活性／非活性<br>表示／非表示 | 選択された項目が支出を受けたものの名称入力を必要とする場合に表示<br>支出を受けたものの名称を表示すること                       |
| 1    | 支出を受けたものの住所     | テキストエリア     | 活性／非活性<br>表示／非表示 | 選択された項目が支出を受けたものの住所入力を必要とする場合に表示<br>支出を受けたものの名称を表示すること                       |
| 1    | 備考                       | テキストエリア     | 活性<br>表示／非表示         | 備考を表示すること                                                                                                             |
| 1    | 領収書を徴しがたかった支出 | セレクトボックス   | 活性<br>表示／非表示         | `0:選択なし`、`1:領収書を徴しがたかった支出の明細書を作成する`、`2:振込明細書に係る支出目的書を作成する`の選択を受け付けること |
| 1    | 交付金に係る支出有無       | チェックボックス   | 活性<br>表示／非表示         | 交付金に係る支出であるかの有無入力を受け付けること                                                                             |
| 1    | 意見付記                   | チェックボックス   | 活性                         | 最新の意見付記の入力を受け付けること                                                                                           |
| 1    | 前例と異なる処理チェック   | チェックボックス   | 活性                         | この処理が前例と異なっていることの入力を受け付けること                                                                         |
| 1    | 自動入力編集チェック       | チェックボックス   | 活性                         | 自動入力部分を変更しようとしていることの入力を受け付けること                                                                   |

## 5. アクション要素一覧

なし

## 6. インターフェイス

### 6.1 収支報告書収入データBalancesheetIncomeInterface

|                    論理名                     |         物理名         |      型      |                              説明(例)                               |
| --------------------------------------------- | ---------------------- | ------------ | ------------------------------------------------------------------- |
| 収入データId                                  | incomeId               | String       | 読み込みした書証Id。例示：「111-20221101-333」                      |
| 収入データ同一識別コード                      | incomeCode             | Long         | 変更した際に同一意味の書証であることを識別するコード。例示：「333」 |
| 書証Id                                        | shoshouId              | String       | 読み込みした書証Id。例示：「111-20221101-333」                      |
| 書証識別コード                                | shoshouHistroyCode     | Long         | 変更した際に同一意味の書証であることを識別するコード。例示：「333」 |
| 書証区分                                      | shoshouKbn             | String       | 書証を区分する。書証アップロード機能参照                            |
| 参照した摘要                                  | referDigest            | String       | 書証に記載された取引概要。例示：「ﾌﾘｺﾐ ﾕｳｹﾝｼｬﾀﾛｳ」                  |
| 入力済項目編集区分                            | isEditAutoInput        | Boolean      | 自動入力部を編集しようとしているかどうか。編集している場合は`true`  |
| 収支報告区分                                  | reportKbn              | Integer      | 支出／収入                                                          |
| 様式仕訳区分                                  | yoshikiKbn             | String       | 様式仕訳区分。収入データ編集参照                                    |
| 様式仕訳枝項目区分                            | yoshikiEdaKbn          | String       | 様式仕訳枝項目区分。収入データ編集参照                              |
| 発生日                                        | accrualDate            | String       | 取引発生日                                                          |
| 取引金額                                      | amount                 | Long         | 取引した金額                                                        |
| 集めた期間開始日                              | mediationStartDate     | String       | あっせんのする場合、期間開始日                                      |
| 集めた期間終了日                              | mediationEndDate       | String       | あっせんのする場合、期間終了日                                      |
| パーティ開催日                                | partyDate              | String       | パーティ開催日                                                      |
| 氏名・団体名称                                | shimeiOrgnizationName  | String       | 氏名(職業)、または団体名称                                          |
| 項目名称                                      | itemName               | String       | 項目名称                                                            |
| 個人・団体住所                                | orgnizationAddress     | Integer      | 個人または団体住所                                                  |
| 備考                                          | biko                   | String       | 備考                                                                |
| 税額控除有無                                  | isCreditTax            | Boolean      | 税控除対象かどうか。該当する場合は`true`                            |
| 寄付が遺贈有無フラグ                          | isBequest              | Boolean      | 寄付が遺贈かどうか。該当する場合は`true`                            |
| 寄付法人が上場または外資50%超え会社有無フラグ | isPrimeListedOrForeign | Boolean      | 寄付法人が上場または外資50%超え会社有無。該当する場合は`true`       |
| 政治資金パーティ名称                          | partyName              | String       | 政治資金パーティ名称                                                |
| 意見付記                                      | note                   | String       | 仕訳に対する意見、メモ                                              |
| 前例と異なる処理フラグ                        | isDifferPrecedent      | String       | 前例と異なる処理を行った場合`true`(仕訳者の主観)                    |
| 保全書証リスト                                | storagedDocumentIdList | List<String> | この仕訳に関して指示内容等を保全した場合の書証Idリスト              |

### 6.2 収支報告書支出データBalancesheetOutcomeInterface

|               論理名               |           物理名            |             型              |                                                        説明(例)                                                        |
| ---------------------------------- | --------------------------- | --------------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| 支出データId                       | outcomeId                   | String                      | 読み込みした書証Id。例示：「111-20221101-333」                                                                         |
| 支出データ同一識別コード           | outcomeCode                 | Long                        | 変更した際に同一意味の書証であることを識別するコード。例示：「333」                                                    |
| 書証Id                             | shoshouId                   | String                      | 読み込みした書証Id。例示「111-20221101-333」                                                                           |
| 書証識別コード                     | shoshouHistroyCode          | Long                        | 変更した際に同一意味の書証であることを識別するコード。例示「333」                                                      |
| 書証区分                           | shoshouKbnl                 | Integer                     | 書証を区分する。書証アップロード機能参照                                                                               |
| 参照した摘要                       | referDigest                 | String                      | 書証に記載された取引概要。例示「ﾋｷｵﾄｼ ﾕｳｹﾝｼｬﾀﾛｳ」                                                                      |
| 入力済項目編集区分                 | isEditAutoInput             | Boolean                     | 自動入力部を編集しようとしているかどうか。編集している場合は`true`                                                     |
| 収支報告区分                       | reportKbn                   | Integer                     | 支出／収入                                                                                                             |
| 様式仕訳区分                       | yoshikiKbn                  | String                      | 様式仕訳区分。支出データ編集参照                                                                                       |
| 様式仕訳枝項目区分                 | yoshikiEdaKbn               | List<SelectOptionInterface> | 様式仕訳枝項目区分。支出データ編集参照                                                                                 |
| 様式仕訳枝項目区分個別用選択リスト | yoshikiEdaKbnOptions        | Integer                     | 様式仕訳枝項目の選択肢設定。支出データ編集参照                                                                         |
| 取引金額                           | amount                      | Long                        | 取引した金額                                                                                                           |
| 発生日                             | accrualDate                 | String                      | 取引発生日                                                                                                             |
| 支出大項目                         | categorizeGroup             | String                      | 例示：パーティを複数回開いた場合、「○×君を応援するパーティ2021」「男性意識改革セミナー2021」などを別集計するための項目 |
| 支出項目                           | itemName                    | String                      |                                                                                                                        |
| 氏名・団体名称                     | shimeiOrgnizationName       | String                      | 個人氏名または団体名称                                                                                                 |
| 団体住所                           | orgnizationAddress          | String                      | 住所                                                                                                                   |
| 備考                               | biko                        | String                      | 備考                                                                                                                   |
| 交付金に係る支出                   | isExpendituresRelatedGrants | Boolean                     | 交付金に係る支出かどうか。かかる支出である場合は`true`                                                                 |
| 領収書を徴しがたかったもの         | notCollectReciptKbn         | Integer                     | 領収書を徴しがたかった支出かどうかを判別する。                                                                         |
| 意見付記                           | note                        | String                      | 仕訳に対する意見、メモ                                                                                                 |
| 前例と異なる処理フラグ             | isDifferPrecedent           | Boolean                     | 前例と異なる処理を行った場合は`true`                                                                                   |
| 保全書証リスト                     | storagedDocumentIdList      | List<String>                | この仕訳に関して指示内容等を保全した場合の書証Idリスト                                                                 |

### 6.3 収支報告対象区分定数

 |            論理名            | 区分(様式) |
 | ---------------------------- | ---------- |
 | 報告対象                     | 1          |
 | 報告対象外(生活費)           | 20         |
 | 報告対象外政治関連(廃止予定) | 11         |
 | タスク計上                   | 50         |

※最新値は4項目。画面イメージでその他の項目数は誤り

## 7. 連携

収入データ変更時、親画面にBack側で解析された政治資金収支報告書収入データクラスを通知する`emit[sendBalancesheetIncomeDto(data,errorInfo)]`
支出データ変更時、親画面にBack側で解析された政治資金収支報告書支出データクラスを通知する`emit[sendBalancesheetOutcomeDto(data,errorInfo)]`
