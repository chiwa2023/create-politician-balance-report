# 一般CSVファイルアップロードコンポーネント設計書

## 状態：一次実装(下記仕様が未確定のため再修正)

## 1. 目的

指定されたCsvをアップロードして、一般Csv形式で返却する

## 2. 構成コンポーネント

なし

## 3.画面イメージ

### 3.1 画面イメージ

![CSV読み取り](./image/CSV読み取り.drawio.png)

### 3.2 画面イメージ(項番)

![CSV読み取り項番](./image/CSV読み取り項番.drawio.png)

## 4. フィールド要素一覧

### 4.1 独自フィールド要素一覧

| 番号 |    論理名    |        タイプ        | 活性／表示 |                  内容                  |
| ---- | ------------ | -------------------- | ---------- | -------------------------------------- |
| 1    | ファイル指定 | インプット(ファイル) | 活性       | アップロードするファイルを指定すること |

※読み取られたデータは即利用されるので、このコンポーネントでは別途表示の必要はないと認識している
※**TODO** 重複読み取りデータについての処理は決定次第修正する。現時点ではある一日のデータすべてが完全一致している場合は重複として除く処理を想定中。絶対実装してはダメな処理…ある1行が一致している場合に、その行を重複とみなし処理対象外とすること。
※各金融機関でダウンロードデータに「処理日付-処理行」のような処理行ID(ある日のある処理にはどんなデータDLの仕方をしても同じIDが割り振られる。異なる口座の情報を混ぜることはないので、口座間での識別を取る必要はない)を振るようになってくれるまで解決のめどはないので、根気よく待つ(><)こと

## 5. アクション要素一覧

| 番号 | 論理名 | タイプ | 活性／表示 |                                                 内容                                                 |
| ---- | ------ | ------ | ---------- | ---------------------------------------------------------------------------------------------------- |
| 1    | 送信   | ボタン | -          | 指定されたCSVファイルをContorllerに渡して保存、一般CSVデータクラスを受け取り、親画面に送信すること。 |

## 6. 一般CSVインターフェイス

CsvAllInterface

|    論理名     |   論理名   |              型              |    説明(例)    |
| ------------- | ---------- | ---------------------------- | -------------- |
| CSVデータ全体 | allCsvData | List<List<CsvCellInterface>> | 全データを表す |

※CsvCellInterfaceはわかりやすさという配慮からあえて設定している。機能だけならStringの2元配列で実装可能

## 6.1 Csvセルデータインターフェイス

CsvCellInterface

|   論理名   | 論理名 |   型   |                                 説明(例)                                 |
| ---------- | ------ | ------ | ------------------------------------------------------------------------ |
| 格納データ | data   | String | Csvの1セルに格納されるデータ。空データはnullではなく`"":空文字`であること |

## 7. 連携

送信ボタンを押下時、親画面にBack側で解析された一般CSVデータクラスを通知する`emit[sendGeneralCsvData(List<List<CsvCell>>,errorInfo)]`
